# Disclaimer

API фасад Python-микросервиса AMANITA на первом этапе реализуется в виде заглушки непосредственно в плагине WordPress. Это позволяет сформировать архитектуру и спецификацию API, исходя из реальных пользовательских сценариев и потребностей самого плагина. После стабилизации интерфейса и бизнес-логики, API будет вынесен в отдельный микросервис и интегрирован с плагином.

---

# Roadmap (User Stories)

## Описание

Данный roadmap отражает стратегию развития плагина Amanita для WordPress/WooCommerce с точки зрения реальных пользовательских сценариев (user stories). Такой подход позволяет сфокусироваться на ценности для конечного пользователя — продавца, интегрирующего свой магазин с экосистемой AMANITA. Все этапы roadmap строятся вокруг ключевых бизнес-процессов: интеграция, синхронизация, управление инвайтами, аналитика, безопасность и удобство работы.

**Ключевые принципы roadmap:**
- MVP ориентирован на одного продавца (single seller), но архитектура закладывает возможность масштабирования.
- Все интеграции с внешними сервисами (Python-микросервис, блокчейн, IPFS) сначала реализуются через заглушки, чтобы быстро проверить и уточнить требования.
- Каждая user story — это самостоятельная ценность для продавца, которую можно реализовать и протестировать независимо.
- Roadmap гибко адаптируется по мере появления новых требований и обратной связи от пользователей.
- Особое внимание уделяется безопасности, прозрачности операций и удобству интерфейса.

---

## 1. Как продавец, я хочу подключить свой WooCommerce-магазин к экосистеме AMANITA, чтобы мои товары и заказы были доступны в блокчейне и IPFS.

**Описание:**

Я, как владелец интернет-магазина на WooCommerce, хочу иметь возможность интегрировать свой магазин с децентрализованной экосистемой AMANITA. Это позволит мне расширить каналы продаж, повысить доверие клиентов за счёт прозрачности и неизменности данных, а также использовать преимущества Web3 (блокчейн, IPFS, токены). Я ожидаю, что процесс подключения будет простым и понятным: достаточно ввести параметры интеграции (API endpoint, ключ, адрес кошелька) и пройти базовую проверку соединения. После успешной интеграции мои товары и заказы должны автоматически отображаться в блокчейне и IPFS, а я — видеть статус подключения и получать уведомления о возможных ошибках. Для меня важно, чтобы интеграция не нарушала привычный процесс работы с WooCommerce и не требовала глубоких технических знаний.

**Задачи:**

1.1 Создать страницу настроек интеграции Amanita в админке WooCommerce
1.2 Реализовать форму для ввода параметров интеграции (API endpoint, API ключ, адрес кошелька)
1.3 Добавить базовую проверку соединения с API
1.4 Сохранять параметры интеграции в базе данных WordPress
1.5 Реализовать отображение статуса подключения
1.6 Реализовать уведомления об ошибках интеграции
1.7 Обеспечить синхронизацию товаров из WooCommerce каталога в блокчейн слой через API, который мы создаем на базе потребностей плагина 

**POC Scope (Proof of Concept):**

- Реализовать серверный API-эндпоинт `/products/upload` (или аналогичный), принимающий массив товаров в формате, согласованном с WooCommerce (id, name, description, price, images, meta)

  **Требования к API endpoint `/products/upload`:**
  
  - Метод: POST
  - Аутентификация: HMAC или Bearer Token (по согласованию, использовать механизм авторизации API сервиса)
  - Content-Type: application/json
  - Тело запроса — JSON-объект следующей структуры:
    ```json
    {
      "seller_address": "0x...", // адрес продавца в блокчейне
      "products": [
        {
          "id": 123, // ID товара в WooCommerce
          "name": "Product Name",
          "description": "Product description (HTML/plain)",
          "price": "19.99",
          "currency": "USD",
          "images": [
            { "cid": "Qm...", "type": "cover" }, // CID обложки
            { "cid": "Qm...", "type": "gallery" }
          ],
          "meta": {
            "sku": "SKU123",
            "stock": 10,
            "categories": ["cat1", "cat2"],
            "tags": ["tag1", "tag2"]
          }
        }
        // ... другие товары
      ]
    }
    ```
  - Все изображения должны быть предварительно загружены в IPFS/блокчейн слой, и в products.images передаются только их CID и тип (cover/gallery).
  - Валидация: обязательные поля — id, name, price, seller_address, хотя бы одно изображение (cover).
  - В случае ошибки — возвращать HTTP 4xx/5xx с описанием проблемы.
  - В случае успеха — возвращать HTTP 200 и массив результатов по каждому товару:
    ```json
    {
      "results": [
        {
          "id": 123,
          "blockchain_id": "0x...", // ID товара в блокчейне
          "tx_hash": "0x...", // хэш транзакции
          "status": "success" // или "error"
        }
        // ...
      ]
    }
    ```
  - Логировать все входящие запросы и ошибки на стороне API.
  - Ограничение: только simple products, вариации не поддерживаются.
  - Документировать все возможные ошибки и коды ответов.

- На стороне WordPress-плагина реализовать экспорт каталога товаров WooCommerce (через WP_Query или WC_Product_Query) с формированием структуры данных, совместимой с API.
- Добавить кнопку "Sync to Blockchain" на странице каталога WooCommerce для ручного запуска синхронизации.
- При нажатии кнопки отправлять POST-запрос на API с данными каталога, используя параметры интеграции (endpoint, ключ, адрес продавца).
- Обрабатывать ответ API: отображать статус (успех/ошибка), сохранять Blockchain ID и/или хэши транзакций в метаполях товаров.
- Логировать все попытки синхронизации (успешные и неуспешные) с деталями ошибок для отладки.
- Для POC не требуется автоматическая синхронизация — только ручной запуск и обработка ответа.
- Не требуется поддержка вариаций, только simple products.
- Требуется поддержка изображений (обложка и галерея должны быть каким-то образом предварительно загружены в блокчейн слой и потом уже можно использовать их CID в запросе с продуктом)
- Авторизация идет только с API через его механизмы.
- Валидация и обработка ошибок на стороне плагина и API.
- Документировать структуру запроса и ответа для API и WooCommerce.

1.8 Сохранить совместимость с привычным процессом работы WooCommerce
1.9 Обеспечить безопасность хранения и передачи ключей/токенов
1.10 Добавить документацию по настройке и использованию интеграции

## 2. Как продавец, я хочу видеть статус интеграции с Python-микросервисом и получать уведомления о проблемах, чтобы быть уверенным в корректной работе синхронизации.

## 3. Как продавец, я хочу вручную синхронизировать отдельный товар с блокчейном через кнопку в админке, чтобы контролировать процесс публикации.

## 4. Как продавец, я хочу видеть в карточке товара статус синхронизации, Blockchain ID, IPFS CID, хэш последней транзакции и детали ошибок, чтобы отслеживать историю публикаций.

## 5. Как продавец, я хочу автоматически синхронизировать товары и заказы при их создании или обновлении, чтобы не тратить время на ручные действия.

## 6. Как продавец, я хочу управлять правилами выдачи инвайтов покупателям (по сумме, периоду, товарам, повторным покупкам), чтобы стимулировать лояльность и рост аудитории.

## 7. Как продавец, я хочу вручную выдавать инвайты отдельным покупателям и видеть историю всех выданных инвайтов, чтобы гибко управлять доступом в экосистему.

## 8. Как продавец, я хочу видеть дашборд с аналитикой по майнингу, использованию токенов и эффективности инвайтов, чтобы оценивать результативность своей работы.

## 9. Как продавец, я хочу получать уведомления о новых заказах, начислениях токенов, активности приглашённых пользователей и ошибках интеграции, чтобы оперативно реагировать на события.

## 10. Как продавец, я хочу настраивать параметры интеграции (API endpoint, ключ, кошелёк, сеть), чтобы адаптировать плагин под свою инфраструктуру.

## 11. Как продавец, я хочу быть уверенным в безопасности хранения ключей и данных, чтобы мои средства и данные клиентов были защищены.

## 12. Как продавец, я хочу, чтобы все операции были прозрачны, логировались и были доступны для аудита, чтобы соответствовать требованиям бизнеса и законодательства.

## 13. Как продавец, я хочу, чтобы плагин поддерживал несколько языков, чтобы мои клиенты и сотрудники могли работать на привычном языке.

## 14. Как продавец, я хочу, чтобы интеграция с кошельком AMANITA была максимально простой для новых пользователей, чтобы снизить барьер входа в экосистему.

## 15. Как продавец, я хочу, чтобы при удалении плагина все мои данные и настройки были полностью очищены, чтобы не оставалось лишней информации в системе.
