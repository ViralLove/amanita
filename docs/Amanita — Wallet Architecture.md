๐ ะััะธัะตะบัััะฐ: Telegram Bot + WebApp Wallet (Amanita)
ะะตััะธั: v0.1 MVP
ะะฒัะพั: CTO
ะฆะตะปั: ะฃะฟัะพััะธัั ะฟะพะปัะทะพะฒะฐัะตะปััะบะธะน ะพะฝะฑะพัะดะธะฝะณ ะฒ Web3 ะฑะตะท Metamask, ัะตัะตะท Telegram-ะฑะพั + WebApp

๐งฑ 1. ะะฑัะฐั ะฐััะธัะตะบัััะฐ

โโโโโโโโโโโโโโโโโโโโโโ
โ   Telegram Client  โ โ ะฟะพะปัะทะพะฒะฐัะตะปั
โโโโโโโโโโฌโโโโโโโโโโโโ
         โ WebApp ะบะฝะพะฟะบะฐ
         โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   WebApp (index.html + ethers.js)     โ
โ  โณ ะณะตะฝะตัะธััะตั/ะฒะพัััะฐะฝะฐะฒะปะธะฒะฐะตั ะบะปััะธ   โ
โ  โณ ััะฐะฝะธั ะฒ localStorage              โ
โ  โณ ะพัะฟัะฐะฒะปัะตั address ะฒ Telegram Bot  โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ Telegram.WebApp.sendData(address)
               โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Telegram Bot (main.py) โ
โ  โณ ะพะฑัะฐะฑะฐััะฒะฐะตั ะฐะดัะตั  โ
โ  โณ ะฒัะทัะฒะฐะตั ะบะพะฝััะฐะบั   โ
โโโโโโโโโโฌโโโโโโโโโโโโโโโโ
         โ HTTP JSON-RPC
         โผ
โโโโโโโโโโโโโโโโโโโโโโ
โ  Web3 Node (Anvil) โ
โ  โณ InviteNFT       โ
โโโโโโโโโโโโโโโโโโโโโโ


โ๏ธ 2. ะะพะผะฟะพะฝะตะฝัั
๐น Telegram Bot (bot/main.py)
ะะฐะฟะธัะฐะฝ ะฝะฐ python-telegram-bot


ะะฑัะฐะฑะฐััะฒะฐะตั /start, inviteCode, web_app_data


ะัะฒะตัะฐะตั ะทะฐ ะฒะฐะปะธะดะฐัะธั, ะฒัะทะพะฒ ัะผะฐัั-ะบะพะฝััะฐะบัะฐ


ะัะฟะพะปัะทัะตั:


web3.py


ะฟัะธะฒะฐัะฝัะน ะบะปัั ะฟัะพะดะฐะฒัะฐ (SELLER_ROLE)


๐น WebApp Wallet (webapp/)
ะะดะฝะพัััะฐะฝะธัะฝัะน HTML + JS


ะะฐะฑะพัะฐะตั ะฒ Telegram WebView


ะะพะดะบะปััะฐะตั:


ethers.js


Telegram.WebApp API


ะะตะฐะปะธะทัะตั:


ะณะตะฝะตัะฐัะธั ะบะพัะตะปัะบะฐ (create)


ะฒะพัััะฐะฝะพะฒะปะตะฝะธะต ะฟะพ ัะธะด-ััะฐะทะต (restore)


ััะฐะฝะตะฝะธะต ะฒ localStorage


ะพัะฟัะฐะฒะบั address ะฒ ะฑะพัะฐ


๐น Web3 Node (Hardhat, Anvil)
ะกะปััะฐะตั ะฝะฐ http://127.0.0.1:8545


ะัะฟะพะปะฝัะตั ััะฐะฝะทะฐะบัะธะธ


ะะพะฝััะฐะบั InviteNFT ะทะฐะดะตะฟะปะพะตะฝ ะทะฐัะฐะฝะตะต



๐ 3. ะัะพัะตัั ะทะฐะฟััะบะฐ ะฝะฐ Mac
๐ ะัะตะดะฟะพะปะฐะณะฐะตะผะฐั ััััะบัััะฐ ะฟัะพะตะบัะฐ:

AMANITA/
โโโ bot/               # Python-ะฑะพั
โ   โโโ main.py
โโโ webapp/            # Telegram WebApp
โ   โโโ index.html
โ   โโโ main.js
โ   โโโ styles.css
โโโ contracts/
โ   โโโ InviteNFT.sol
โโโ .env
โโโ README.md


๐งช ะจะฐะณะธ ะทะฐะฟััะบะฐ ะฒ dev-ััะตะดะต (3 ัะตัะผะธะฝะฐะปะฐ)
โ ะขะตัะผะธะฝะฐะป 1: Web3-ะฝะพะดะฐ

npx hardhat node

โ ะขะตัะผะธะฝะฐะป 2: HTTP WebApp

cd amanita/webapp
python3 -m http.server 8080

๐ ะะพัััะฟะฝะพ ะฟะพ http://localhost:8080/index.html
โ ะขะตัะผะธะฝะฐะป 3: Telegram-ะฑะพั

cd amanita/bot
python3 main.py

ะคะฐะนะป .env:

BOT_TOKEN=123456:ABCD...
SELLER_PRIVATE_KEY=0xabc...
WEB3_PROVIDER_URL=http://127.0.0.1:8545
WEBAPP_URL=http://localhost:8080/index.html


๐ 4. ะะทะฐะธะผะพะดะตะนััะฒะธะต ะฑะพัะฐ ั WebApp
๐น ะัะทะพะฒ WebApp ะธะท ะฑะพัะฐ

from telegram import InlineKeyboardButton, InlineKeyboardMarkup

keyboard = InlineKeyboardMarkup([
  [InlineKeyboardButton(
    text="๐ ะกะพะทะดะฐัั ะบะพัะตะปัะบ",
    web_app={"url": WEBAPP_URL}
  )]
])

bot.send_message(chat_id, text="ะกะพะทะดะฐะน ะบะพัะตะปัะบ", reply_markup=keyboard)

๐น ะะพะปััะตะฝะธะต ะฐะดัะตัะฐ ะพั WebApp

@application.message_handler(content_types=['web_app_data'])
def receive_wallet(update, context):
    wallet_address = update.message.web_app_data.data
    user_id = update.message.from_user.id
    # ะกะพััะฐะฝัะตะผ ะธะปะธ ะฟัะธะฒัะทัะฒะฐะตะผ ะฐะดัะตั
    # ะัะทัะฒะฐะตะผ activateAndMintInvites(...)


๐งฉ 5. ะะฐะบ WebApp ัะตัะฐะตั ะทะฐะดะฐัะธ
โ ะะตะฝะตัะฐัะธั ะบะพัะตะปัะบะฐ
ethers.Wallet.createRandom()


ะกะพััะฐะฝัะตััั: mnemonic, address, privateKey ะฒ localStorage


ะัะฟัะฐะฒะบะฐ address ะฒ ะฑะพั: Telegram.WebApp.sendData(address)


โ ะะพัััะฐะฝะพะฒะปะตะฝะธะต
ะะฒะพะด ัะธะด-ััะฐะทั


ethers.Wallet.fromPhrase(mnemonic)


ะะพะฒัะพัะฝะฐั ะฟัะธะฒัะทะบะฐ ะฐะดัะตัะฐ



๐ก 6. WebApp = ะฐะปััะตัะฝะฐัะธะฒะฐ Metamask
ะะพะทะผะพะถะฝะพััั
Metamask
Amanita WebApp
ะฅัะฐะฝะตะฝะธะต ะบะปััะตะน
ะ ัะฐััะธัะตะฝะธะธ
ะ localStorage
ะกะตัั
ะัะฑะพั ะฒัััะฝัั
ะฃะบะฐะทะฐะฝะฐ ะถัััะบะพ
ะะพะดะฟะธัั ััะฐะฝะทะฐะบัะธะน
ะงะตัะตะท UI
ะะต ัะตะฐะปะธะทะพะฒะฐะฝะฐ (ะฟะพะบะฐ)
ะัะทะพะฒ ะบะพะฝััะฐะบัะฐ
ะก ะบะปะธะตะฝัะฐ
ะก ะฑัะบะตะฝะดะฐ ัะตัะตะท bot
ะะตะทะตัะฒะฝะพะต ะฒะพัััะฐะฝะพะฒะปะตะฝะธะต
Seed-ััะฐะทะฐ
Seed-ััะฐะทะฐ

โก ะ MVP โ ัะพะปัะบะพ address ััะฐะฝะธััั, ะฟะพะดะฟะธัั ะฒะฝะต ะบะปะธะตะฝัะฐ (ัะตัะตะท SELLER).

โ๏ธ 7. ะะณัะฐะฝะธัะตะฝะธั
WebApp ัะฐะฑะพัะฐะตั ัะพะปัะบะพ ะฒ WebView Telegram


localStorage ะฝะต ัะธะฝััะพะฝะธะทะธััะตััั ะผะตะถะดั ััััะพะนััะฒะฐะผะธ


ะะพัะตัั ัะธะด-ััะฐะทั = ะฟะพัะตัั ะดะพัััะฟะฐ


ะะพะบะฐ ะฝะตั ะฟะพะปะฝะพัะตะฝะฝะพะน ะฟะพะดะฟะธัะธ/ะพัะฟัะฐะฒะบะธ ััะฐะฝะทะฐะบัะธะน ะพั ะฟะพะปัะทะพะฒะฐัะตะปั



๐ 8. ะะตะทัะผะต
ะะพะผะฟะพะฝะตะฝั
ะัะฒะตัััะฒะตะฝะฝะพััั
Telegram Bot
ะะฝะฒะฐะนัั, ัะฟัะฐะฒะปะตะฝะธะต ะฐะดัะตัะฐะผะธ, ะบะพะฝััะฐะบัั
WebApp Wallet
ะะตะฝะตัะฐัะธั ะธ ะฒะพัััะฐะฝะพะฒะปะตะฝะธะต ะฐะดัะตัะฐ
Web3 Node
ะัะฟะพะปะฝะตะฝะธะต activateAndMintInvites


