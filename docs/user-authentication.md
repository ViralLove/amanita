# User Authentication Concept

## Цель
Ограничить доступ к каталогу продуктов только для пользователей, у которых есть SBT (Soulbound Token), которым является активированный инвайт (Invite NFT).

## Краткое описание
- После авторизации пользователя бот/сервис проверяет наличие у пользователя активированного Invite NFT (выполняющего функцию SBT) в блокчейне.
- Если SBT есть — пользователь получает доступ к каталогу и другим функциям.
- Если SBT нет — доступ к каталогу и другим функциям ограничен, предлагается пройти онбординг/активацию инвайта.

## Технические детали (обновлено на основе анализа кода)

### Реализованная архитектура:
- **AccountService**: Центральный сервис управления аккаунтами
- **BlockchainService**: Singleton для работы с блокчейном
- **UserSettings**: Модель пользовательских настроек с Web3 интеграцией

### Текущие ограничения:
- Активация инвайтов доступна только через `SELLER_ROLE`
- Функция `activateInvite` не реализована в контракте
- Требуется `activateAndMintInvites` для полной функциональности

### Интеграционные точки:
- `ProductRegistry` принимает адрес `InviteNFT` в конструкторе
- Централизованный реестр `AmanitaRegistry` управляет адресами
- Все контракты загружаются динамически из реестра

## Следующие шаги (обновлено)
- [ ] Исправить несоответствие API: заменить `activateInvite` на `activateAndMintInvites`
- [ ] Проверить и обновить ABI для всех контрактов
- [ ] Реализовать middleware для проверки SBT перед выдачей каталога
- [ ] Добавить обработку ошибок для неавторизованных пользователей
- [ ] Интегрировать кэширование статуса авторизации